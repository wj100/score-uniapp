{"version":3,"file":"double.js","sources":["pages/double/double.vue","pages/double/double.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- 双打队员选择 -->\n    <view class=\"section\">\n      <text class=\"section-title\">双打队员</text>\n      \n      <!-- A队 -->\n      <view class=\"team-section\">\n        <text class=\"team-label\">A队</text>\n        <view class=\"team-players\">\n          <view class=\"player-item\">\n            <picker :value=\"selectedPlayerA1Index\" :range=\"availablePlayersA1\" @change=\"onPlayerA1Change\">\n              <view class=\"picker\">\n                <text>{{ playerA1 || '选择队员1' }}</text>\n                <text class=\"arrow\">▼</text>\n              </view>\n            </picker>\n          </view>\n          \n          <text class=\"and-text\">&</text>\n          \n          <view class=\"player-item\">\n            <picker :value=\"selectedPlayerA2Index\" :range=\"availablePlayersA2\" @change=\"onPlayerA2Change\">\n              <view class=\"picker\">\n                <text>{{ playerA2 || '选择队员2' }}</text>\n                <text class=\"arrow\">▼</text>\n              </view>\n            </picker>\n          </view>\n        </view>\n      </view>\n\n      <!-- VS -->\n      <view class=\"vs-section\">\n        <text class=\"vs-text\">vs</text>\n      </view>\n\n      <!-- B队 -->\n      <view class=\"team-section\">\n        <text class=\"team-label\">B队</text>\n        <view class=\"team-players\">\n          <view class=\"player-item\">\n            <picker :value=\"selectedPlayerB1Index\" :range=\"availablePlayersB1\" @change=\"onPlayerB1Change\">\n              <view class=\"picker\">\n                <text>{{ playerB1 || '选择队员3' }}</text>\n                <text class=\"arrow\">▼</text>\n              </view>\n            </picker>\n          </view>\n          \n          <text class=\"and-text\">&</text>\n          \n          <view class=\"player-item\">\n            <picker :value=\"selectedPlayerB2Index\" :range=\"availablePlayersB2\" @change=\"onPlayerB2Change\">\n              <view class=\"picker\">\n                <text>{{ playerB2 || '选择队员4' }}</text>\n                <text class=\"arrow\">▼</text>\n              </view>\n            </picker>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 比分输入 -->\n    <view class=\"section\">\n      <text class=\"section-title\">比分</text>\n      <view class=\"score-section\">\n        <view class=\"score-item\">\n          <text class=\"team-name\">A队</text>\n          <view class=\"score-input\">\n            <input \n              type=\"number\" \n              v-model=\"scoreA\" \n              placeholder=\"0\"\n              @input=\"onScoreAInput\"\n            />\n          </view>\n        </view>\n        \n        <view class=\"vs-text\">vs</view>\n        \n        <view class=\"score-item\">\n          <text class=\"team-name\">B队</text>\n          <view class=\"score-input\">\n            <input \n              type=\"number\" \n              v-model=\"scoreB\" \n              placeholder=\"0\"\n              @input=\"onScoreBInput\"\n            />\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 提交按钮 -->\n    <view class=\"submit-section\">\n      <button \n        class=\"submit-btn\" \n        :class=\"{ disabled: !canSubmit }\" \n        @click=\"submitScore\"\n        :disabled=\"!canSubmit\"\n      >\n        提交双打比分\n      </button>\n    </view>\n\n    <!-- 今日已提交 -->\n    <view class=\"section\">\n      <text class=\"section-title\">今日已提交:</text>\n      <view class=\"today-matches\">\n        <view v-if=\"todayMatches.length === 0\" class=\"no-data\">\n          <text>暂无数据</text>\n        </view>\n        <view v-else class=\"matches-list\">\n          <view class=\"matches-header\">\n            <text class=\"header-item\">对战</text>\n            <text class=\"header-item\">比分</text>\n            <text class=\"header-item\">操作</text>\n          </view>\n          <view \n            v-for=\"match in todayMatches\" \n            :key=\"match.id\" \n            class=\"match-item\"\n          >\n            <text class=\"match-teams\">\n              {{ match.teamA.join('&') }} vs {{ match.teamB.join('&') }}\n            </text>\n            <text class=\"match-score\">{{ match.scoreA }} - {{ match.scoreB }}</text>\n            <text class=\"match-action\">🟢</text>\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { getPlayers, saveDoubleMatch, getDoubleMatches, initPlayers } from '@/utils/storage.js'\n\nexport default {\n  data() {\n    return {\n      players: [],\n      playerA1: '',\n      playerA2: '',\n      playerB1: '',\n      playerB2: '',\n      scoreA: '',\n      scoreB: '',\n      selectedPlayerA1Index: -1,\n      selectedPlayerA2Index: -1,\n      selectedPlayerB1Index: -1,\n      selectedPlayerB2Index: -1,\n      todayMatches: []\n    }\n  },\n  \n  computed: {\n    selectedPlayers() {\n      return [this.playerA1, this.playerA2, this.playerB1, this.playerB2].filter(p => p)\n    },\n    \n    availablePlayersA1() {\n      return this.players.filter(player => !this.selectedPlayers.includes(player) || player === this.playerA1)\n    },\n    \n    availablePlayersA2() {\n      return this.players.filter(player => !this.selectedPlayers.includes(player) || player === this.playerA2)\n    },\n    \n    availablePlayersB1() {\n      return this.players.filter(player => !this.selectedPlayers.includes(player) || player === this.playerB1)\n    },\n    \n    availablePlayersB2() {\n      return this.players.filter(player => !this.selectedPlayers.includes(player) || player === this.playerB2)\n    },\n    \n    canSubmit() {\n      return this.playerA1 && \n             this.playerA2 && \n             this.playerB1 && \n             this.playerB2 &&\n             this.playerA1 !== this.playerA2 &&\n             this.playerB1 !== this.playerB2 &&\n             this.selectedPlayers.length === 4 &&\n             new Set(this.selectedPlayers).size === 4 &&\n             this.scoreA !== '' && \n             this.scoreB !== '' &&\n             (parseInt(this.scoreA) > 0 || parseInt(this.scoreB) > 0)\n    }\n  },\n  \n  onLoad() {\n    this.loadData()\n  },\n  \n  onShow() {\n    this.loadTodayMatches()\n  },\n  \n  methods: {\n    async loadData() {\n      try {\n        console.log('开始加载队员数据...')\n        this.players = await getPlayers()\n        console.log('获取到的队员列表:', this.players)\n        \n        if (this.players.length === 0) {\n          console.log('队员列表为空，尝试初始化...')\n          // 尝试初始化队员\n          const initResult = await initPlayers()\n          console.log('初始化结果:', initResult)\n          if (initResult) {\n            this.players = await getPlayers()\n            console.log('重新获取队员列表:', this.players)\n          }\n        }\n        \n        this.loadTodayMatches()\n      } catch (error) {\n        console.error('加载队员数据失败:', error)\n        // 使用默认队员数据\n        this.players = ['吉志', '小鲁', '建华', '汪骏', '杭宁']\n        uni.showToast({\n          title: '加载失败，使用默认数据',\n          icon: 'none'\n        })\n      }\n    },\n    \n    async loadTodayMatches() {\n      const allMatches = await getDoubleMatches('today')\n      this.todayMatches = allMatches\n    },\n    \n    onPlayerA1Change(e) {\n      this.selectedPlayerA1Index = e.detail.value\n      this.playerA1 = this.availablePlayersA1[e.detail.value]\n      this.updateAvailableIndexes()\n    },\n    \n    onPlayerA2Change(e) {\n      this.selectedPlayerA2Index = e.detail.value\n      this.playerA2 = this.availablePlayersA2[e.detail.value]\n      this.updateAvailableIndexes()\n    },\n    \n    onPlayerB1Change(e) {\n      this.selectedPlayerB1Index = e.detail.value\n      this.playerB1 = this.availablePlayersB1[e.detail.value]\n      this.updateAvailableIndexes()\n    },\n    \n    onPlayerB2Change(e) {\n      this.selectedPlayerB2Index = e.detail.value\n      this.playerB2 = this.availablePlayersB2[e.detail.value]\n      this.updateAvailableIndexes()\n    },\n    \n    updateAvailableIndexes() {\n      // 更新各个选择器的索引\n      if (this.playerA1) {\n        this.selectedPlayerA1Index = this.availablePlayersA1.indexOf(this.playerA1)\n      }\n      if (this.playerA2) {\n        this.selectedPlayerA2Index = this.availablePlayersA2.indexOf(this.playerA2)\n      }\n      if (this.playerB1) {\n        this.selectedPlayerB1Index = this.availablePlayersB1.indexOf(this.playerB1)\n      }\n      if (this.playerB2) {\n        this.selectedPlayerB2Index = this.availablePlayersB2.indexOf(this.playerB2)\n      }\n    },\n    \n    onScoreAInput(e) {\n      this.scoreA = e.detail.value\n    },\n    \n    onScoreBInput(e) {\n      this.scoreB = e.detail.value\n    },\n    \n    async submitScore() {\n      if (!this.canSubmit) {\n        return\n      }\n      \n      uni.showLoading({\n        title: '提交中...'\n      })\n      \n      try {\n        const match = {\n          teamA: [this.playerA1, this.playerA2],\n          teamB: [this.playerB1, this.playerB2],\n          scoreA: parseInt(this.scoreA),\n          scoreB: parseInt(this.scoreB)\n        }\n        \n        const result = await saveDoubleMatch(match)\n        if (result) {\n          uni.showToast({\n            title: '提交成功',\n            icon: 'success'\n          })\n          \n          // 重置表单\n          this.resetForm()\n          // 刷新今日比赛\n          this.loadTodayMatches()\n        } else {\n          uni.showToast({\n            title: '提交失败',\n            icon: 'error'\n          })\n        }\n      } catch (error) {\n        console.error('提交失败:', error)\n        uni.showToast({\n          title: '提交失败',\n          icon: 'error'\n        })\n      } finally {\n        uni.hideLoading()\n      }\n    },\n    \n    resetForm() {\n      this.playerA1 = ''\n      this.playerA2 = ''\n      this.playerB1 = ''\n      this.playerB2 = ''\n      this.scoreA = ''\n      this.scoreB = ''\n      this.selectedPlayerA1Index = -1\n      this.selectedPlayerA2Index = -1\n      this.selectedPlayerB1Index = -1\n      this.selectedPlayerB2Index = -1\n    }\n  }\n}\n</script>\n\n<style scoped>\n.container {\n  padding: 32rpx;\n  background-color: #f5f5f5;\n  min-height: 100vh;\n}\n\n.section {\n  margin-bottom: 48rpx;\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 24rpx;\n  display: block;\n}\n\n.team-section {\n  background: white;\n  border-radius: 16rpx;\n  padding: 32rpx;\n  margin-bottom: 16rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.1);\n}\n\n.team-label {\n  font-size: 28rpx;\n  font-weight: bold;\n  color: #4CAF50;\n  margin-bottom: 24rpx;\n  display: block;\n}\n\n.team-players {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.player-item {\n  flex: 1;\n}\n\n.picker {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 24rpx;\n  background: #f8f8f8;\n  border-radius: 12rpx;\n  border: 2rpx solid #e0e0e0;\n}\n\n.picker text:first-child {\n  color: #333;\n  font-size: 28rpx;\n}\n\n.arrow {\n  color: #666;\n  font-size: 24rpx;\n}\n\n.and-text {\n  margin: 0 16rpx;\n  font-size: 24rpx;\n  color: #666;\n}\n\n.vs-section {\n  text-align: center;\n  margin: 24rpx 0;\n}\n\n.vs-text {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #4CAF50;\n}\n\n.score-section {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: white;\n  border-radius: 16rpx;\n  padding: 32rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.1);\n}\n\n.score-item {\n  flex: 1;\n  text-align: center;\n}\n\n.team-name {\n  display: block;\n  font-size: 28rpx;\n  color: #666;\n  margin-bottom: 16rpx;\n}\n\n.score-input {\n  background: #f8f8f8;\n  border-radius: 12rpx;\n  border: 2rpx solid #e0e0e0;\n  overflow: hidden;\n}\n\n.score-input input {\n  width: 100%;\n  padding: 24rpx;\n  text-align: center;\n  font-size: 36rpx;\n  font-weight: bold;\n  background: transparent;\n  border: none;\n}\n\n.submit-section {\n  margin-bottom: 48rpx;\n}\n\n.submit-btn {\n  width: 100%;\n  background: #4CAF50;\n  color: white;\n  border: none;\n  border-radius: 50rpx;\n  padding: 32rpx;\n  font-size: 32rpx;\n  font-weight: bold;\n}\n\n.submit-btn.disabled {\n  background: #ccc;\n}\n\n.today-matches {\n  background: white;\n  border-radius: 16rpx;\n  overflow: hidden;\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.1);\n}\n\n.no-data {\n  padding: 80rpx;\n  text-align: center;\n  color: #999;\n}\n\n.matches-header {\n  display: flex;\n  background: #f8f8f8;\n  padding: 24rpx 32rpx;\n  border-bottom: 2rpx solid #e0e0e0;\n}\n\n.header-item {\n  flex: 1;\n  text-align: center;\n  font-size: 28rpx;\n  color: #666;\n  font-weight: bold;\n}\n\n.match-item {\n  display: flex;\n  padding: 24rpx 32rpx;\n  border-bottom: 2rpx solid #f0f0f0;\n}\n\n.match-item:last-child {\n  border-bottom: none;\n}\n\n.match-teams,\n.match-score,\n.match-action {\n  flex: 1;\n  text-align: center;\n  font-size: 26rpx;\n  color: #333;\n}\n</style>\n","import MiniProgramPage from '/Users/wangjun/netease/mine/Scoring/uniapp/pages/double/double.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getPlayers","initPlayers","getDoubleMatches","saveDoubleMatch"],"mappings":";;;AA6IA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,SAAS,CAAE;AAAA,MACX,UAAU;AAAA,MACV,UAAU;AAAA,MACV,UAAU;AAAA,MACV,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,uBAAuB;AAAA,MACvB,uBAAuB;AAAA,MACvB,uBAAuB;AAAA,MACvB,uBAAuB;AAAA,MACvB,cAAc,CAAC;AAAA,IACjB;AAAA,EACD;AAAA,EAED,UAAU;AAAA,IACR,kBAAkB;AAChB,aAAO,CAAC,KAAK,UAAU,KAAK,UAAU,KAAK,UAAU,KAAK,QAAQ,EAAE,OAAO,OAAK,CAAC;AAAA,IAClF;AAAA,IAED,qBAAqB;AACnB,aAAO,KAAK,QAAQ,OAAO,YAAU,CAAC,KAAK,gBAAgB,SAAS,MAAM,KAAK,WAAW,KAAK,QAAQ;AAAA,IACxG;AAAA,IAED,qBAAqB;AACnB,aAAO,KAAK,QAAQ,OAAO,YAAU,CAAC,KAAK,gBAAgB,SAAS,MAAM,KAAK,WAAW,KAAK,QAAQ;AAAA,IACxG;AAAA,IAED,qBAAqB;AACnB,aAAO,KAAK,QAAQ,OAAO,YAAU,CAAC,KAAK,gBAAgB,SAAS,MAAM,KAAK,WAAW,KAAK,QAAQ;AAAA,IACxG;AAAA,IAED,qBAAqB;AACnB,aAAO,KAAK,QAAQ,OAAO,YAAU,CAAC,KAAK,gBAAgB,SAAS,MAAM,KAAK,WAAW,KAAK,QAAQ;AAAA,IACxG;AAAA,IAED,YAAY;AACV,aAAO,KAAK,YACL,KAAK,YACL,KAAK,YACL,KAAK,YACL,KAAK,aAAa,KAAK,YACvB,KAAK,aAAa,KAAK,YACvB,KAAK,gBAAgB,WAAW,KAChC,IAAI,IAAI,KAAK,eAAe,EAAE,SAAS,KACvC,KAAK,WAAW,MAChB,KAAK,WAAW,OACf,SAAS,KAAK,MAAM,IAAI,KAAK,SAAS,KAAK,MAAM,IAAI;AAAA,IAC/D;AAAA,EACD;AAAA,EAED,SAAS;AACP,SAAK,SAAS;AAAA,EACf;AAAA,EAED,SAAS;AACP,SAAK,iBAAiB;AAAA,EACvB;AAAA,EAED,SAAS;AAAA,IACP,MAAM,WAAW;AACf,UAAI;AACFA,sBAAAA,qDAAY,aAAa;AACzB,aAAK,UAAU,MAAMC,yBAAW;AAChCD,sBAAY,MAAA,MAAA,OAAA,kCAAA,aAAa,KAAK,OAAO;AAErC,YAAI,KAAK,QAAQ,WAAW,GAAG;AAC7BA,wBAAAA,MAAY,MAAA,OAAA,kCAAA,iBAAiB;AAE7B,gBAAM,aAAa,MAAME,0BAAY;AACrCF,wBAAAA,MAAA,MAAA,OAAA,kCAAY,UAAU,UAAU;AAChC,cAAI,YAAY;AACd,iBAAK,UAAU,MAAMC,yBAAW;AAChCD,0BAAY,MAAA,MAAA,OAAA,kCAAA,aAAa,KAAK,OAAO;AAAA,UACvC;AAAA,QACF;AAEA,aAAK,iBAAiB;AAAA,MACtB,SAAO,OAAO;AACdA,sBAAAA,MAAc,MAAA,SAAA,kCAAA,aAAa,KAAK;AAEhC,aAAK,UAAU,CAAC,MAAM,MAAM,MAAM,MAAM,IAAI;AAC5CA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,SACP;AAAA,MACH;AAAA,IACD;AAAA,IAED,MAAM,mBAAmB;AACvB,YAAM,aAAa,MAAMG,cAAgB,iBAAC,OAAO;AACjD,WAAK,eAAe;AAAA,IACrB;AAAA,IAED,iBAAiB,GAAG;AAClB,WAAK,wBAAwB,EAAE,OAAO;AACtC,WAAK,WAAW,KAAK,mBAAmB,EAAE,OAAO,KAAK;AACtD,WAAK,uBAAuB;AAAA,IAC7B;AAAA,IAED,iBAAiB,GAAG;AAClB,WAAK,wBAAwB,EAAE,OAAO;AACtC,WAAK,WAAW,KAAK,mBAAmB,EAAE,OAAO,KAAK;AACtD,WAAK,uBAAuB;AAAA,IAC7B;AAAA,IAED,iBAAiB,GAAG;AAClB,WAAK,wBAAwB,EAAE,OAAO;AACtC,WAAK,WAAW,KAAK,mBAAmB,EAAE,OAAO,KAAK;AACtD,WAAK,uBAAuB;AAAA,IAC7B;AAAA,IAED,iBAAiB,GAAG;AAClB,WAAK,wBAAwB,EAAE,OAAO;AACtC,WAAK,WAAW,KAAK,mBAAmB,EAAE,OAAO,KAAK;AACtD,WAAK,uBAAuB;AAAA,IAC7B;AAAA,IAED,yBAAyB;AAEvB,UAAI,KAAK,UAAU;AACjB,aAAK,wBAAwB,KAAK,mBAAmB,QAAQ,KAAK,QAAQ;AAAA,MAC5E;AACA,UAAI,KAAK,UAAU;AACjB,aAAK,wBAAwB,KAAK,mBAAmB,QAAQ,KAAK,QAAQ;AAAA,MAC5E;AACA,UAAI,KAAK,UAAU;AACjB,aAAK,wBAAwB,KAAK,mBAAmB,QAAQ,KAAK,QAAQ;AAAA,MAC5E;AACA,UAAI,KAAK,UAAU;AACjB,aAAK,wBAAwB,KAAK,mBAAmB,QAAQ,KAAK,QAAQ;AAAA,MAC5E;AAAA,IACD;AAAA,IAED,cAAc,GAAG;AACf,WAAK,SAAS,EAAE,OAAO;AAAA,IACxB;AAAA,IAED,cAAc,GAAG;AACf,WAAK,SAAS,EAAE,OAAO;AAAA,IACxB;AAAA,IAED,MAAM,cAAc;AAClB,UAAI,CAAC,KAAK,WAAW;AACnB;AAAA,MACF;AAEAH,oBAAAA,MAAI,YAAY;AAAA,QACd,OAAO;AAAA,OACR;AAED,UAAI;AACF,cAAM,QAAQ;AAAA,UACZ,OAAO,CAAC,KAAK,UAAU,KAAK,QAAQ;AAAA,UACpC,OAAO,CAAC,KAAK,UAAU,KAAK,QAAQ;AAAA,UACpC,QAAQ,SAAS,KAAK,MAAM;AAAA,UAC5B,QAAQ,SAAS,KAAK,MAAM;AAAA,QAC9B;AAEA,cAAM,SAAS,MAAMI,cAAe,gBAAC,KAAK;AAC1C,YAAI,QAAQ;AACVJ,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,WACP;AAGD,eAAK,UAAU;AAEf,eAAK,iBAAiB;AAAA,eACjB;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,WACP;AAAA,QACH;AAAA,MACA,SAAO,OAAO;AACdA,sBAAAA,MAAc,MAAA,SAAA,kCAAA,SAAS,KAAK;AAC5BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,SACP;AAAA,MACH,UAAU;AACRA,sBAAAA,MAAI,YAAY;AAAA,MAClB;AAAA,IACD;AAAA,IAED,YAAY;AACV,WAAK,WAAW;AAChB,WAAK,WAAW;AAChB,WAAK,WAAW;AAChB,WAAK,WAAW;AAChB,WAAK,SAAS;AACd,WAAK,SAAS;AACd,WAAK,wBAAwB;AAC7B,WAAK,wBAAwB;AAC7B,WAAK,wBAAwB;AAC7B,WAAK,wBAAwB;AAAA,IAC/B;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvVA,GAAG,WAAW,eAAe;"}